{% load static %}

<div class="type-group" data-level="{{ item.level }}" data-type-id="{{ item.type.id }}">
    <!-- Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ -->
    <div class="{% if item.level == 0 %}parent-type{% else %}child-type{% endif %} {% if not item.type.is_active %}opacity-50{% endif %}">
        
        <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
                <!-- Ù…Ø³Ø§ÙØ© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ -->
                {% if item.level > 0 %}
                    <span class="me-3"></span>
                {% endif %}
                
                <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù†ÙˆØ¹ -->
                <span class="type-icon me-3">
                    {% if item.type.code == 'ASSET' %}ğŸ¢
                    {% elif item.type.code == 'LIABILITY' %}ğŸ“‹
                    {% elif item.type.code == 'EQUITY' %}ğŸ›ï¸
                    {% elif item.type.code == 'REVENUE' %}ğŸ’°
                    {% elif item.type.code == 'EXPENSE' %}ğŸ“Š
                    {% elif item.type.code == 'CURRENT_ASSET' %}ğŸ¢
                    {% elif item.type.code == 'CURRENT_LIABILITY' %}ğŸ“‹
                    {% elif item.type.code == 'CASH' %}ğŸ’°
                    {% elif item.type.code == 'BANK' %}ğŸ¦
                    {% elif item.type.code == 'INVENTORY' %}ğŸ“¦
                    {% elif item.type.code == 'RECEIVABLES' %}ğŸ‘¥
                    {% elif item.type.code == 'PAYABLES' %}ğŸª
                    {% elif item.type.code == 'SALES_REVENUE' %}ğŸ’µ
                    {% elif item.type.code == 'OTHER_REVENUE' %}ğŸ’¸
                    {% elif item.type.code == 'COGS' %}ğŸ“Š
                    {% elif item.type.code == 'CAPITAL' %}ğŸ›ï¸
                    {% elif item.type.code == 'PARTNER_ACCOUNT' %}ğŸ‘¤
                    {% elif item.type.code == 'RETAINED_EARNINGS' %}ğŸ’¼
                    {% elif item.type.code == 'SALES_DISTRIBUTION_EXPENSE' %}ğŸšš
                    {% elif item.type.code == 'MARKETING_ADVERTISING_EXPENSE' %}ğŸ“¢
                    {% elif item.type.code == 'DEPRECIATION_EXPENSE' %}ğŸ“‰
                    {% elif item.type.code == 'INTEREST_EXPENSE' %}ğŸ’¸
                    {% elif item.type.code == 'OTHER_EXPENSE' %}ğŸ“‹
                    {% elif item.type.code == 'NOTES_RECEIVABLE' %}ğŸ“„
                    {% elif item.type.code == 'NOTES_PAYABLE' %}ğŸ“‘
                    {% elif item.type.code == 'PREPAID_EXPENSES' %}â°
                    {% elif item.type.code == 'ACCRUED_EXPENSES' %}â³
                    {% elif item.type.code == 'UNEARNED_REVENUE' %}ğŸ”„
                    {% elif item.type.code == 'LONG_TERM_LIABILITY' %}ğŸ“Š
                    {% elif item.type.code == 'LONG_TERM_LOANS' %}ğŸ¦
                    {% elif item.type.code == 'CURRENT_YEAR_EARNINGS' %}ğŸ“ˆ
                    {% else %}ğŸ“
                    {% endif %}
                </span>
                
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†ÙˆØ¹ -->
                <div>
                    <div class="type-name">
                        {{ item.type.name }}
                        {% if item.has_children %}
                            <button class="btn btn-sm btn-outline-secondary ms-2 toggle-children" 
                                    data-target="#children-{{ item.type.id }}" 
                                    style="font-size: 0.7rem; padding: 0.1rem 0.3rem;">
                                <i class="fas fa-chevron-down"></i>
                            </button>
                        {% endif %}
                    </div>
                    <div class="type-category">
                        <small class="text-muted">{{ item.type.code }} - Ø§Ù„Ù…Ø³ØªÙˆÙ‰ {{ item.type.level }}</small>
                    </div>
                </div>
            </div>
            
            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ÙˆØ£Ø²Ø±Ø§Ø± -->
            <div class="d-flex align-items-center gap-2">
                <!-- Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª -->
                {% if item.accounts_count > 0 %}
                <span class="badge bg-info me-1">
                    {{ item.accounts_count }} Ø­Ø³Ø§Ø¨
                </span>
                {% endif %}
                
                <!-- Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„ -->
                {% if item.children_count > 0 %}
                <span class="badge bg-secondary me-1">
                    {{ item.children_count }} ÙØ±Ø¹ÙŠ
                </span>
                {% endif %}
                
                <!-- Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· -->
                {% if not item.type.is_active %}
                <span class="badge bg-danger me-1">ØºÙŠØ± Ù†Ø´Ø·</span>
                {% endif %}
                
                <!-- Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ -->
                <span class="type-nature">
                    {% if item.type.nature == 'debit' %}
                        <span class="badge bg-success">Ù…Ø¯ÙŠÙ†</span>
                    {% else %}
                        <span class="badge bg-warning">Ø¯Ø§Ø¦Ù†</span>
                    {% endif %}
                </span>
                

                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
                <a href="{% url 'financial:account_types_edit' item.type.pk %}" 
                   class="btn btn-edit" title="ØªØ¹Ø¯ÙŠÙ„">
                    <i class="fas fa-edit"></i>
                </a>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ù„Ø£Ø·ÙØ§Ù„ (Ù…Ø®ÙÙŠÙŠÙ† Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹) -->
    {% if item.has_children %}
    <div id="children-{{ item.type.id }}" class="children-container" style="display: none;">
        {% for child in item.children %}
            {% include 'financial/advanced/account_type_tree_item.html' with item=child %}
        {% endfor %}
    </div>
    {% endif %}
</div>
