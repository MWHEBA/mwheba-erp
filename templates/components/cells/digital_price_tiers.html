{% load custom_filters %}

{% comment %}
خلية الشرائح السعرية للطباعة الديجيتال
المعلمات المطلوبة:
- item: عنصر البيانات الذي يحتوي على service و details
{% endcomment %}

{% if item.service.price_tiers.exists %}
<div class="text-center">
    <div class="mb-2">
        <span class="badge bg-success px-2 py-1">
            <i class="fas fa-layer-group me-1"></i>
            {{ item.service.price_tiers.count }} شريحة
        </span>
    </div>
    
    {% for tier in item.service.price_tiers.all|slice:":2" %}
    <div class="small text-muted mb-1">
        <strong>{{ tier.get_quantity_range_display }}:</strong>
        <span class="text-success">{{ tier.price_per_unit|custom_number_format }} ج.م</span>
        {% if tier.floor_price %}
        <br><small class="text-info">أرضيات: {{ tier.floor_price|custom_number_format }} ج.م</small>
        {% endif %}
    </div>
    {% endfor %}
    
    {% if item.service.price_tiers.count > 2 %}
    <small class="text-muted">
        <i class="fas fa-ellipsis-h"></i>
        +{{ item.service.price_tiers.count|add:"-2" }} شريحة أخرى
    </small>
    {% endif %}
</div>
{% else %}
<div class="text-center text-muted">
    <i class="fas fa-exclamation-triangle text-warning"></i>
    <small class="d-block">لا توجد شرائح</small>
</div>
{% endif %}
