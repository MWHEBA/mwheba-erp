<!-- نموذج خدمات التغطية -->
<div class="coating-service-form">
    <!-- اسم الخدمة (تلقائي) -->
    <div class="row g-3 mb-3">
        <div class="col-md-12">
            <div class="form-floating">
                <input type="text" class="form-control" name="name" id="service-name" 
                       placeholder="اسم الخدمة" required readonly
                       style="background-color: #f8f9fa;"
                       value="{% if service %}{{ service.name }}{% endif %}">
                <label for="service-name">اسم الخدمة (تلقائي) *</label>
            </div>
        </div>
    </div>

    <!-- الصف الأول: نوع التغطية وطريقة الحساب -->
    <div class="row g-3 mb-4">
        <div class="col-md-6">
            <div class="form-floating">
                <select name="coating_type" class="form-select" id="coating-type" required>
                    <option value="">اختر نوع التغطية</option>
                    {% for value, label in form_choices.coating_types %}
                        <option value="{{ value }}" {% if service and service.coating_details and service.coating_details.coating_type_id == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
                <label for="coating-type">نوع التغطية *</label>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-floating">
                <select name="calculation_method" class="form-select" id="calculation-method" required>
                    <option value="">اختر طريقة الحساب</option>
                    <option value="per_piece" {% if service and service.coating_details and service.coating_details.calculation_method == 'per_piece' %}selected{% endif %}>بالقطعة</option>
                    <option value="per_thousand" {% if service and service.coating_details and service.coating_details.calculation_method == 'per_thousand' %}selected{% endif %}>بالألف</option>
                    <option value="per_square_meter" {% if service and service.coating_details and service.coating_details.calculation_method == 'per_square_meter' %}selected{% endif %}>بالمتر المربع</option>
                    <option value="per_sheet" {% if service and service.coating_details and service.coating_details.calculation_method == 'per_sheet' %}selected{% endif %}>بالفرخ</option>
                    <option value="per_hour" {% if service and service.coating_details and service.coating_details.calculation_method == 'per_hour' %}selected{% endif %}>بالساعة</option>
                </select>
                <label for="calculation-method">طريقة الحساب *</label>
            </div>
        </div>
    </div>

    <!-- الصف الثاني: التسعير والكمية (3 حقول) -->
    <div class="row g-3 mb-4">
        <div class="col-md-4">
            <div class="form-floating">
                <input type="number" class="form-control" name="base_price" 
                       id="base-price" placeholder="السعر الأساسي" min="0" step="0.01" required
                       value="{% if service and service.coating_details %}{{ service.coating_details.price_per_unit }}{% endif %}">
                <label for="base-price">السعر الأساسي ({{ currency_symbol }}) *</label>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-floating">
                <input type="number" class="form-control" name="setup_cost" 
                       id="setup-cost" placeholder="تكلفة التجهيز" min="0" step="0.01"
                       value="{% if service %}{{ service.setup_cost|default:'' }}{% endif %}">
                <label for="setup-cost">تكلفة التجهيز ({{ currency_symbol }})</label>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-floating">
                <input type="number" class="form-control" name="min_quantity" 
                       id="min-quantity" placeholder="الحد الأدنى" min="1">
                <label for="min-quantity">الحد الأدنى للكمية</label>
            </div>
        </div>
    </div>

    <!-- الصف الثالث: الوصف والحالة -->
    <div class="row g-3 mb-4">
        <div class="col-md-8">
            <div class="form-floating">
                <textarea class="form-control" name="description" id="description" 
                          placeholder="وصف الخدمة" style="height: 70px;">{% if service %}{{ service.description }}{% endif %}</textarea>
                <label for="description">وصف الخدمة (اختياري)</label>
            </div>
        </div>
        <div class="col-md-4 d-flex align-items-center justify-content-center">
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" name="is_active" 
                       id="is-active" {% if not service or service.is_active %}checked{% endif %}>
                <label class="form-check-label fw-medium" for="is-active">
                    الخدمة نشطة ومتاحة
                </label>
            </div>
        </div>
    </div>
</div>

<script>
// تحديث اسم الخدمة تلقائياً من نوع التغطية
function updateServiceName() {
    const nameField = document.getElementById('service-name');
    const coatingTypeField = document.getElementById('coating-type');
    
    if (coatingTypeField.value) {
        const selectedOption = coatingTypeField.options[coatingTypeField.selectedIndex];
        // استخدام نص نوع التغطية مباشرة كاسم للخدمة
        nameField.value = `خدمة ${selectedOption.text}`;
    } else {
        nameField.value = '';
    }
}

// ربط الحدث
document.getElementById('coating-type').addEventListener('change', updateServiceName);
</script>
