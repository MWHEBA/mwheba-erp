# 📋 دليل نظام التسعير المحسن - mwheba ERP

## 🎯 نظرة عامة

تم تطوير نظام التسعير المحسن في mwheba ERP ليوفر حسابات دقيقة وتلقائية لتكلفة المطبوعات. النظام يدعم الطباعة الأوفست والرقمية مع حساب شامل لجميع التكاليف.

---

## 🚀 الميزات الرئيسية

### ✅ **حسابات تلقائية دقيقة**
- حساب تكلفة المواد حسب نوع ووزن ومقاس الورق
- حساب تكلفة الطباعة (أوفست/رقمية)
- حساب تكلفة الزنكات للطباعة الأوفست
- حساب تكلفة خدمات التشطيب
- تطبيق هامش الربح تلقائياً (20% افتراضي)

### ✅ **واجهة مستخدم محسنة**
- مؤشر خطوات تفاعلي (4 خطوات)
- تحديث أسعار الورق في الوقت الفعلي
- عرض ملخص التكلفة بشكل جذاب
- تصميم متجاوب يعمل على جميع الأجهزة

### ✅ **نظام APIs متقدم**
- 8 APIs متخصصة للحسابات
- معالجة أخطاء شاملة
- أمان عالي مع CSRF protection
- دعم JSON للتفاعل السلس

---

## 🔗 الروابط المهمة

| الصفحة | الرابط | الوصف |
|---------|---------|--------|
| **التسعير المحسن** | `/pricing/enhanced/` | الواجهة الجديدة للتسعير |
| **اختبار APIs** | `/pricing/test-apis/` | صفحة اختبار الـ APIs |
| **لوحة التحكم** | `/pricing/` | لوحة تحكم التسعير الرئيسية |
| **إنشاء طلب** | `/pricing/add/` | إنشاء طلب تسعير جديد |

---

## 📊 APIs المتاحة

### 1. **APIs البيانات الأساسية**
```
GET /pricing/api/v2/paper-types/     # أنواع الورق
GET /pricing/api/v2/paper-sizes/     # مقاسات الورق  
GET /pricing/api/v2/suppliers/       # الموردين
```

### 2. **APIs الحسابات**
```
POST /pricing/api/v2/calculate-cost/        # حساب التكلفة الإجمالية
GET  /pricing/api/v2/paper-price/           # سعر الورق من المورد
GET  /pricing/api/v2/plate-price/           # سعر الزنكات
GET  /pricing/api/v2/digital-printing-price/ # سعر الطباعة الرقمية
POST /pricing/api/v2/finishing-cost/        # تكلفة التشطيب
```

### 3. **APIs التقارير**
```
GET /pricing/api/v2/order-summary/{id}/     # ملخص طلب التسعير
```

---

## 🛠️ كيفية الاستخدام

### **الطريقة الأولى: الواجهة المحسنة**

1. **انتقل للرابط:** `http://127.0.0.1:8000/pricing/enhanced/`

2. **املأ البيانات الأساسية:**
   - نوع الطلب (أوفست/رقمي)
   - الكمية المطلوبة
   - المورد
   - ملاحظات (اختياري)

3. **حدد تفاصيل الورق:**
   - نوع الورق
   - مقاس الورق
   - وزن الورق
   - سيظهر سعر الورق تلقائياً

4. **اختر خيارات الطباعة:**
   - ألوان الوجه الأمامي
   - ألوان الوجه الخلفي

5. **اضغط "احسب التكلفة"**
   - سيتم حساب جميع التكاليف تلقائياً
   - عرض ملخص شامل للتكلفة

### **الطريقة الثانية: اختبار APIs**

1. **انتقل للرابط:** `http://127.0.0.1:8000/pricing/test-apis/`

2. **اختبر APIs مختلفة:**
   - أنواع الورق
   - مقاسات الورق
   - الموردين
   - حساب التكلفة

---

## 💡 أمثلة عملية

### **مثال 1: طباعة بروشور**
- **النوع:** أوفست
- **الكمية:** 1000 نسخة
- **الورق:** كوشيه 150 جرام، A4
- **الطباعة:** 4 ألوان وجه واحد
- **النتيجة:** حساب دقيق لجميع التكاليف

### **مثال 2: طباعة فلاير**
- **النوع:** رقمي
- **الكمية:** 500 نسخة
- **الورق:** عادي 120 جرام، A5
- **الطباعة:** فول كلر وجهين
- **النتيجة:** تكلفة محسوبة بدقة

---

## 🔧 البيانات المتاحة

### **أنواع الورق (3 أنواع):**
- ورق عادي
- ورق كوشيه
- ورق مقوى

### **مقاسات الورق (4 مقاسات):**
- A3 (29.7×42.0 سم)
- A4 (21.0×29.7 سم)
- A5 (14.8×21.0 سم)
- 70×100 سم

### **أوزان الورق المدعومة:**
- 80 جرام
- 90 جرام
- 120 جرام
- 150 جرام
- 200 جرام

### **الموردين (8 موردين نشطين):**
- موردين للورق مع أسعار متنوعة
- موردين للطباعة الرقمية
- موردين للزنكات CTP

---

## 📈 إحصائيات النظام

### **البيانات المتاحة:**
- **180 خدمة ورق** بأسعار مختلفة
- **24 خدمة طباعة رقمية** 
- **6 خدمات زنكات CTP**
- **إجمالي: 210 خدمة**

### **التغطية:**
- ✅ جميع أنواع الورق مع جميع الموردين
- ✅ جميع المقاسات مع أوزان مختلفة
- ✅ طباعة ملونة وأبيض وأسود
- ✅ حسابات دقيقة للتكاليف

---

## 🧪 اختبار النظام

### **اختبار سريع:**
```bash
# تشغيل اختبار شامل
python test_pricing_apis.py
```

### **النتائج المتوقعة:**
- ✅ أنواع الورق: 3 أنواع
- ✅ مقاسات الورق: 4 مقاسات  
- ✅ الموردين: 8 موردين
- ✅ حساب التكلفة: يعمل بنجاح

### **مثال نتيجة الحساب:**
```
تكلفة المواد: 1050.00 جنيه
تكلفة الطباعة: 160.00 جنيه
تكلفة الزنكات: 0.00 جنيه
تكلفة التشطيب: 0.00 جنيه
التكلفة الإجمالية: 1210.00 جنيه
سعر البيع المقترح: 1452.00 جنيه
```

---

## 🔍 استكشاف الأخطاء

### **مشاكل شائعة وحلولها:**

#### **1. لا تظهر أسعار الورق**
- **السبب:** لا توجد خدمة ورق للمورد المحدد
- **الحل:** اختر مورد آخر أو أضف خدمة ورق جديدة

#### **2. خطأ في حساب التكلفة**
- **السبب:** بيانات مفقودة أو غير صحيحة
- **الحل:** تأكد من ملء جميع الحقول المطلوبة

#### **3. بطء في التحميل**
- **السبب:** كمية كبيرة من البيانات
- **الحل:** النظام محسن للأداء، انتظر قليلاً

#### **4. خطأ في الاتصال**
- **السبب:** مشكلة في الخادم
- **الحل:** تأكد من تشغيل الخادم على المنفذ 8000

---

## 🚀 التطوير المستقبلي

### **الميزات المخططة:**
- [ ] إضافة المزيد من خدمات التشطيب
- [ ] نظام عروض أسعار متقدم
- [ ] تقارير تحليلية للتكاليف
- [ ] ربط مع أنظمة المحاسبة
- [ ] تطبيق جوال للتسعير

### **التحسينات المقترحة:**
- [ ] ذاكرة تخزين مؤقت للأسعار
- [ ] نظام إشعارات للتغييرات
- [ ] واجهة إدارة الموردين
- [ ] نظام موافقات متدرج

---

## 📞 الدعم والمساعدة

### **للمساعدة التقنية:**
- **البريد الإلكتروني:** support@mwheba.com
- **الهاتف:** +20 xxx xxx xxxx

### **للتطوير والتخصيص:**
- **المطور:** فريق mwheba ERP
- **التوثيق:** هذا الدليل + التعليقات في الكود

---

## 📝 ملاحظات مهمة

### **⚠️ تنبيهات:**
1. **تأكد من تشغيل الخادم** قبل استخدام النظام
2. **احفظ البيانات** بانتظام لتجنب فقدانها
3. **اختبر الحسابات** قبل الاعتماد عليها في العمل
4. **حدّث الأسعار** دورياً لضمان الدقة

### **✅ أفضل الممارسات:**
1. **استخدم الواجهة المحسنة** للحصول على أفضل تجربة
2. **اختبر APIs** قبل التطوير عليها
3. **راجع النتائج** دائماً قبل تقديم العروض
4. **احتفظ بنسخ احتياطية** من البيانات المهمة

---

## 🎉 خلاصة

نظام التسعير المحسن في mwheba ERP يوفر:
- **حسابات دقيقة وسريعة** لتكلفة المطبوعات
- **واجهة مستخدم حديثة** وسهلة الاستخدام  
- **APIs قوية** للتطوير والتكامل
- **بيانات شاملة** لجميع أنواع الطباعة

النظام جاهز للاستخدام الفوري ويمكن تطويره وتخصيصه حسب احتياجات العمل.

---

*آخر تحديث: أكتوبر 2025 | الإصدار: 2.0*
