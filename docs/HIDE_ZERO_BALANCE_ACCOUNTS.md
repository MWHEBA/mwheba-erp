# إخفاء حسابات الموردين والعملاء ذات الأرصدة الصفرية

## الهدف
تقليل عدد الحسابات المعروضة في دليل الحسابات بإخفاء حسابات الموردين والعملاء النهائية التي رصيدها صفر.

## التحديثات المطبقة

### 1. ملف العرض: `financial/views/account_views.py`

#### في دالة `chart_of_accounts_list`:
- تم تحديث دالة `build_tree_data()` لفحص الحسابات النهائية تحت العملاء والموردين
- إذا كان الرصيد = 0، يتم تخطي الحساب من العرض
- الفحص يتم بالبحث في شجرة الحسابات الأب للكلمات المفتاحية: `العملاء`, `الموردون`, `عملاء`, `موردين`, `موردون`

#### في دالة `chart_tree_api`:
- تم تطبيق نفس المنطق في API الشجرة الديناميكية
- يدعم كل من:
  - جلب حساب معين مع أطفاله
  - بناء الشجرة الكاملة (expand_all)
  - جلب الجذور فقط

### 2. القالب: `templates/financial/components/enhanced_account_row.html`

- تم إضافة فحص في حلقة عرض الحسابات الفرعية
- يتحقق من:
  1. هل الحساب نهائي (is_leaf)
  2. هل الرصيد = 0
  3. هل الحساب الأب يحتوي على كلمات مفتاحية للعملاء/الموردين
- إذا تحققت الشروط الثلاثة، لا يتم عرض الحساب

## الكلمات المفتاحية المستخدمة للفحص
- `العملاء`
- `الموردون`
- `عملاء`
- `موردين`
- `موردون`

## السلوك

### ما يتم إخفاؤه:
✅ حسابات العملاء النهائية برصيد = 0
✅ حسابات الموردين النهائية برصيد = 0

### ما يظل ظاهراً:
✅ جميع حسابات العملاء والموردين برصيد ≠ 0
✅ جميع الحسابات الأب (غير النهائية) للعملاء والموردين
✅ جميع الحسابات الأخرى (غير العملاء والموردين) بغض النظر عن الرصيد

## مثال

### قبل التحديث:
```
الموردون (حساب أب)
├── مورد أ (رصيد: 5000)  ← يظهر
├── مورد ب (رصيد: 0)     ← يظهر
└── مورد ج (رصيد: -2000) ← يظهر
```

### بعد التحديث:
```
الموردون (حساب أب)
├── مورد أ (رصيد: 5000)  ← يظهر
└── مورد ج (رصيد: -2000) ← يظهر
```

## الفوائد
1. **تقليل الفوضى**: عرض الحسابات النشطة فقط
2. **أداء أفضل**: تقليل عدد الصفوف المعروضة
3. **تجربة مستخدم محسنة**: التركيز على الحسابات ذات الحركة المالية

## ملاحظات
- التحديث لا يؤثر على قاعدة البيانات
- الحسابات المخفية لا تزال موجودة ويمكن الوصول إليها مباشرة
- يمكن عرض الحسابات غير النشطة باستخدام خيار "show_inactive"
