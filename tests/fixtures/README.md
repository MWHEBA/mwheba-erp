# Demo Transactions Fixtures

## الوصف
ملف `demo_transactions.json` يحتوي على بيانات تجريبية كاملة مع القيود المحاسبية لسيناريوهات الشراء والبيع التالية:

### 1. فاتورة شراء نقدي (PUR0001)
- **المورد**: شركة الورق السعودية
- **المنتج**: كوشيه 300 جم
- **الكمية**: 500 فرخ × 5 ج = 2500 ج
- **طريقة الدفع**: نقدي
- **حالة الدفع**: مدفوعة بالكامل

### 2. فاتورة شراء آجل (PUR0002)
- **المورد**: مطابع الخليج الرقمية
- **المنتجات**:
  - أوفست 80جم: 1000 × 2.50 = 2500 ج
  - دوبلكس 250جم: 300 × 4 = 1200 ج
- **الإجمالي**: 3700 ج
- **طريقة الدفع**: آجل
- **حالة الدفع**: مدفوعة جزئياً (تم دفع 2000 ج)

### 3. فاتورة بيع نقدي (SALE0001)
- **العميل**: راقيات الإبداع
- **المنتج**: كوشيه 300 جم
- **الكمية**: 100 × 7 = 700 ج
- **طريقة الدفع**: نقدي
- **حالة الدفع**: مدفوعة بالكامل

### 4. فاتورة بيع آجل (SALE0002)
- **العميل**: تراست بلس
- **المنتجات**:
  - أوفست 80: 200 × 3.5 = 700 ج
  - دوبلكس 250: 50 × 5.50 = 275 ج
- **الإجمالي**: 975 ج
- **طريقة الدفع**: آجل
- **حالة الدفع**: مدفوعة جزئياً (تم تحصيل 500 ج)

## الحساب المالي المستخدم
- **كود الحساب**: 11011
- **اسم الحساب**: الصندوق الرئيسي (الخزينة)

## كيفية التحميل

### الطريقة الموصى بها (باستخدام setup_development.py):

```bash
python setup_development.py
```

هذا السكريبت سيحمل جميع البيانات تلقائياً بالترتيب الصحيح.

### الطريقة اليدوية:

```bash
# 1. تحميل بيانات المستخدمين
python manage.py loaddata users/fixtures/initial_data.json

# 2. تحميل بيانات المنتجات والمخازن
python manage.py loaddata product/fixtures/initial_data.json

# 3. تحميل بيانات الموردين
python manage.py loaddata supplier/fixtures/initial_data.json

# 4. تحميل بيانات العملاء
python manage.py loaddata client/fixtures/initial_data.json

# 5. تحميل الحسابات المالية والفترة المحاسبية
python manage.py loaddata financial/fixtures/chart_of_accounts_final.json

# 6. تحميل الفواتير التجريبية (باستخدام السكريبت)
python tests/fixtures/load_demo_transactions.py
```

**ملاحظة مهمة**: ملف `demo_transactions.json` لم يعد يُستخدم. استخدم السكريبت `load_demo_transactions.py` بدلاً منه.

## الحسابات المحاسبية المُنشأة

### حسابات العملاء (في client/fixtures/initial_data.json):
- **1103003**: عميل - راقيات الإبداع
- **1103004**: عميل - شركة تراست بلس

### حسابات الموردين (في supplier/fixtures/initial_data.json):
- **2101003**: مورد - شركة الورق السعودية
- **2101004**: مورد - مطابع الخليج الرقمية

## القيود المحاسبية المُنشأة

### القيد 1 (JE-2025-0001): فاتورة مشتريات نقدي
- **مدين**: تكلفة البضاعة المباعة (51010) - 2500 ج
- **دائن**: الصندوق الرئيسي (11011) - 2500 ج

### القيد 2 (JE-2025-0002): فاتورة مشتريات آجل
- **مدين**: تكلفة البضاعة المباعة (51010) - 3700 ج
- **دائن**: مورد - مطابع الخليج (2101004) - 3700 ج

### القيد 3 (JE-2025-0003): دفع لمورد
- **مدين**: مورد - مطابع الخليج (2101004) - 2000 ج
- **دائن**: الصندوق الرئيسي (11011) - 2000 ج

### القيد 4 (JE-2025-0004): فاتورة مبيعات نقدي
- **مدين**: الصندوق الرئيسي (11011) - 700 ج
- **دائن**: إيرادات المبيعات (41010) - 700 ج

### القيد 5 (JE-2025-0005): فاتورة مبيعات آجل
- **مدين**: عميل - تراست بلس (1103004) - 975 ج
- **دائن**: إيرادات المبيعات (41010) - 975 ج

### القيد 6 (JE-2025-0006): تحصيل من عميل
- **مدين**: الصندوق الرئيسي (11011) - 500 ج
- **دائن**: عميل - تراست بلس (1103004) - 500 ج

## ملاحظات مهمة
1. ✅ **جميع القيود المحاسبية مُنشأة ومرحّلة** - الفكستشرز تحتوي على القيود الكاملة
2. ✅ **الربط الصحيح** - كل فاتورة مربوطة بقيدها المحاسبي
3. ✅ **حالة التزامن** - جميع الدفعات في حالة "synced" (متزامنة مع النظام المالي)
4. يجب تحميل الـ fixtures بالترتيب المذكور أعلاه لتجنب أخطاء Foreign Key
5. جميع الدفعات في حالة "posted" (مرحّلة)
6. الحساب المالي المستخدم هو الصندوق الرئيسي (1)
7. التواريخ المستخدمة في يناير 2025

## التحقق من البيانات
بعد التحميل، يمكنك التحقق من البيانات:

```bash
# عرض فواتير الشراء
python manage.py shell
>>> from purchase.models import Purchase
>>> Purchase.objects.all()

# عرض فواتير البيع
>>> from sale.models import Sale
>>> Sale.objects.all()

# عرض القيود المحاسبية
>>> from financial.models import JournalEntry
>>> JournalEntry.objects.all()
>>> # يجب أن تشاهد 6 قيود محاسبية

# التحقق من الربط بين الفواتير والقيود
>>> p1 = Purchase.objects.get(number='PUR0001')
>>> p1.journal_entry  # يجب أن يكون JE-2025-0001
>>> s1 = Sale.objects.get(number='SALE0001')
>>> s1.journal_entry  # يجب أن يكون JE-2025-0004
```

## الرصيد المتوقع للصندوق الرئيسي
بعد تحميل جميع المعاملات، الرصيد النهائي للصندوق:
- **دائن**: 2500 (شراء نقدي) + 2000 (دفع لمورد) = 4500 ج
- **مدين**: 700 (بيع نقدي) + 500 (تحصيل من عميل) = 1200 ج
- **الرصيد النهائي**: 1200 - 4500 = **-3300 ج** (عجز في الصندوق)
