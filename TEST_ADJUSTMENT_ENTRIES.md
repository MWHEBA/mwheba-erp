# ุฏููู ุงุฎุชุจุงุฑ ูุธุงู ุงููููุฏ ุงูุชุตุญูุญูุฉ

## ๐งช ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### ุงูุณููุงุฑูู 1: ุชุนุฏูู ูุงุชูุฑุฉ ูุจูุนุงุช ูุฑุญููุฉ (ุฒูุงุฏุฉ ุงููุจูุบ)

#### ุงูุฎุทูุงุช:
1. ุฅูุดุงุก ูุงุชูุฑุฉ ูุจูุนุงุช:
   ```
   - ุงูุนููู: ุฃู ุนููู
   - ุงูููุชุฌ: ููุชุฌ ูู cost_price
   - ุงููููุฉ: 10
   - ุงูุณุนุฑ: 1000 ุฌ.ู
   - ุงูุฅุฌูุงูู: 10,000 ุฌ.ู
   ```

2. ุงูุชุญูู ูู ุฅูุดุงุก ุงูููุฏ ุงููุญุงุณุจู:
   ```sql
   SELECT * FROM financial_journalentry 
   WHERE reference LIKE '%SALE-%'
   ORDER BY id DESC LIMIT 1;
   ```

3. ุชุนุฏูู ุงููุงุชูุฑุฉ:
   ```
   - ุชุบููุฑ ุงููููุฉ ุฅูู: 15
   - ุงูุฅุฌูุงูู ุงูุฌุฏูุฏ: 15,000 ุฌ.ู
   ```

4. ุงูุชุญูู ูู ุงูููุฏ ุงูุชุตุญูุญู:
   ```sql
   SELECT * FROM financial_journalentry 
   WHERE reference LIKE '%ุชุตุญูุญ ูุงุชูุฑุฉ ูุจูุนุงุช%'
   ORDER BY id DESC LIMIT 1;
   ```

#### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```
โ ููุฏ ุชุตุญูุญู ุจูุจูุบ 5,000 ุฌ.ู
โ ูุฏูู: ุงูุนููู 5,000
โ ุฏุงุฆู: ุฅูุฑุงุฏุงุช ุงููุจูุนุงุช 5,000
โ ููุฏ ุชุตุญูุญ ุงูุชูููุฉ (ุญุณุจ cost_price)
```

---

### ุงูุณููุงุฑูู 2: ุชุนุฏูู ูุงุชูุฑุฉ ูุจูุนุงุช ูุฑุญููุฉ (ููุต ุงููุจูุบ)

#### ุงูุฎุทูุงุช:
1. ุฅูุดุงุก ูุงุชูุฑุฉ ูุจูุนุงุช:
   ```
   - ุงูุฅุฌูุงูู: 20,000 ุฌ.ู
   ```

2. ุชุนุฏูู ุงููุงุชูุฑุฉ:
   ```
   - ุชูููู ุงููููุฉ
   - ุงูุฅุฌูุงูู ุงูุฌุฏูุฏ: 15,000 ุฌ.ู
   ```

#### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```
โ ููุฏ ุชุตุญูุญู ุจูุจูุบ 5,000 ุฌ.ู
โ ุฏุงุฆู: ุงูุนููู 5,000 (ุชุฎููุถ ุงูุฐูุฉ)
โ ูุฏูู: ุฅูุฑุงุฏุงุช ุงููุจูุนุงุช 5,000 (ุชุฎููุถ ุงูุฅูุฑุงุฏุงุช)
```

---

### ุงูุณููุงุฑูู 3: ุชุนุฏูู ูุงุชูุฑุฉ ูุดุชุฑูุงุช ูุฑุญููุฉ (ุฒูุงุฏุฉ ุงููุจูุบ)

#### ุงูุฎุทูุงุช:
1. ุฅูุดุงุก ูุงุชูุฑุฉ ูุดุชุฑูุงุช:
   ```
   - ุงูููุฑุฏ: ุฃู ููุฑุฏ
   - ุงูุฅุฌูุงูู: 10,000 ุฌ.ู
   ```

2. ุชุนุฏูู ุงููุงุชูุฑุฉ:
   ```
   - ุฒูุงุฏุฉ ุงููููุฉ
   - ุงูุฅุฌูุงูู ุงูุฌุฏูุฏ: 15,000 ุฌ.ู
   ```

#### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```
โ ููุฏ ุชุตุญูุญู ุจูุจูุบ 5,000 ุฌ.ู
โ ูุฏูู: ุงููุฎุฒูู 5,000
โ ุฏุงุฆู: ุงูููุฑุฏ 5,000
```

---

### ุงูุณููุงุฑูู 4: ุชุนุฏูู ูุงุชูุฑุฉ ุบูุฑ ูุฑุญููุฉ

#### ุงูุฎุทูุงุช:
1. ุฅูุดุงุก ูุงุชูุฑุฉ ุจุฏูู ููุฏ ูุญุงุณุจู
2. ุชุนุฏูู ุงููุงุชูุฑุฉ

#### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```
โ ุชู ุงูุชุนุฏูู ุจูุฌุงุญ
โ ูู ูุชู ุฅูุดุงุก ููุฏ ุชุตุญูุญู (ูุฃู ุงููุงุชูุฑุฉ ุบูุฑ ูุฑุญููุฉ)
โ ุฑุณุงูุฉ: "ุชู ุชุนุฏูู ูุงุชูุฑุฉ ุงููุจูุนุงุช ุจูุฌุงุญ"
```

---

### ุงูุณููุงุฑูู 5: ุชุนุฏูู ุจุฏูู ูุฑููุงุช

#### ุงูุฎุทูุงุช:
1. ุฅูุดุงุก ูุงุชูุฑุฉ ูุฑุญููุฉ
2. ุชุนุฏูู ุงููุงุชูุฑุฉ ุจููุณ ุงููุจูุบ (ูุซูุงู ุชุบููุฑ ุงููุตู ููุท)

#### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```
โ ุชู ุงูุชุนุฏูู ุจูุฌุงุญ
โ ูู ูุชู ุฅูุดุงุก ููุฏ ุชุตุญูุญู (ูุง ุชูุฌุฏ ูุฑููุงุช)
โ ุฑุณุงูุฉ: "ูุง ุชูุฌุฏ ูุฑููุงุช ุชุชุทูุจ ููุฏ ุชุตุญูุญู"
```

---

## ๐ ุงุณุชุนูุงูุงุช ุงูุชุญูู

### 1. ุงูุชุญูู ูู ุงููููุฏ ุงูุชุตุญูุญูุฉ:
```sql
SELECT 
    je.number,
    je.date,
    je.entry_type,
    je.reference,
    je.description,
    SUM(jel.debit) as total_debit,
    SUM(jel.credit) as total_credit
FROM financial_journalentry je
LEFT JOIN financial_journalentryline jel ON je.id = jel.journal_entry_id
WHERE je.entry_type = 'adjustment'
GROUP BY je.id
ORDER BY je.date DESC;
```

### 2. ุงูุชุญูู ูู ุชุทุงุจู ุงููููุฏ:
```sql
-- ูุฌุจ ุฃู ูููู ุงููุฌููุน = 0 (ุงููุฏูู = ุงูุฏุงุฆู)
SELECT 
    journal_entry_id,
    SUM(debit) - SUM(credit) as balance
FROM financial_journalentryline
GROUP BY journal_entry_id
HAVING balance != 0;
```

### 3. ุงูุชุญูู ูู ุญุฑูุงุช ุงููุฎุฒูู:
```sql
SELECT 
    sm.reference_number,
    sm.movement_type,
    sm.quantity,
    sm.document_type,
    sm.document_number,
    sm.notes,
    sm.created_at
FROM product_stockmovement sm
WHERE sm.reference_number LIKE '%EDIT%'
ORDER BY sm.created_at DESC;
```

### 4. ุงูุชุญูู ูู ุฃุฑุตุฏุฉ ุงูุนููุงุก:
```sql
SELECT 
    c.name,
    c.balance,
    SUM(CASE WHEN jel.account_id = c.financial_account_id THEN jel.debit - jel.credit ELSE 0 END) as calculated_balance
FROM client_customer c
LEFT JOIN financial_journalentryline jel ON jel.account_id = c.financial_account_id
LEFT JOIN financial_journalentry je ON je.id = jel.journal_entry_id
WHERE je.status = 'posted'
GROUP BY c.id;
```

---

## ๐ ุงูุชูุงุฑูุฑ ุงููุทููุจุฉ

### 1. ุชูุฑูุฑ ุงููููุฏ ุงูุชุตุญูุญูุฉ:
```python
from financial.models import JournalEntry

adjustment_entries = JournalEntry.objects.filter(
    entry_type='adjustment'
).order_by('-date')

for entry in adjustment_entries:
    print(f"ุงูููุฏ: {entry.number}")
    print(f"ุงูุชุงุฑูุฎ: {entry.date}")
    print(f"ุงููุฑุฌุน: {entry.reference}")
    print(f"ุงููุตู: {entry.description}")
    print("---")
```

### 2. ุชูุฑูุฑ ุงูุชุทุงุจู:
```python
from financial.models import JournalEntryLine
from django.db.models import Sum

# ุงูุชุญูู ูู ุชูุงุฒู ุงููููุฏ
unbalanced = JournalEntryLine.objects.values('journal_entry').annotate(
    balance=Sum('debit') - Sum('credit')
).exclude(balance=0)

if unbalanced.exists():
    print("โ๏ธ ุชูุฌุฏ ูููุฏ ุบูุฑ ูุชูุงุฒูุฉ!")
    for item in unbalanced:
        print(f"ุงูููุฏ: {item['journal_entry']}, ุงููุฑู: {item['balance']}")
else:
    print("โ ุฌููุน ุงููููุฏ ูุชูุงุฒูุฉ")
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู

### ูุจู ุงูุงุฎุชุจุงุฑ:
- [ ] ุงูุชุฃูุฏ ูู ูุฌูุฏ ุญุณุงุจุงุช ูุญุงุณุจูุฉ ุฃุณุงุณูุฉ
- [ ] ุงูุชุฃูุฏ ูู ูุฌูุฏ ููุชุฌุงุช ููุง cost_price
- [ ] ุงูุชุฃูุฏ ูู ูุฌูุฏ ุนููุงุก ูููุฑุฏูู
- [ ] ุงูุชุฃูุฏ ูู ูุฌูุฏ ูุชุฑุฉ ูุญุงุณุจูุฉ ูุดุทุฉ

### ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ:
- [ ] ุงุฎุชุจุงุฑ ุฒูุงุฏุฉ ุงููุจูุบ
- [ ] ุงุฎุชุจุงุฑ ููุต ุงููุจูุบ
- [ ] ุงุฎุชุจุงุฑ ูุงุชูุฑุฉ ุบูุฑ ูุฑุญููุฉ
- [ ] ุงุฎุชุจุงุฑ ุจุฏูู ูุฑููุงุช
- [ ] ุงุฎุชุจุงุฑ ูุน ููุชุฌุงุช ุจุฏูู cost_price

### ุจุนุฏ ุงูุงุฎุชุจุงุฑ:
- [ ] ุงูุชุญูู ูู ุงููููุฏ ุงูุชุตุญูุญูุฉ
- [ ] ุงูุชุญูู ูู ุชูุงุฒู ุงููููุฏ
- [ ] ุงูุชุญูู ูู ุญุฑูุงุช ุงููุฎุฒูู
- [ ] ุงูุชุญูู ูู ุฃุฑุตุฏุฉ ุงูุนููุงุก ูุงูููุฑุฏูู
- [ ] ุงูุชุญูู ูู ุงูุชูุงุฑูุฑ ุงููุงููุฉ

---

## ๐ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ ูุญููููุง

### ุฎุทุฃ: "ูุง ูููู ุงูุนุซูุฑ ุนูู ุงูุญุณุงุจุงุช ุงููุญุงุณุจูุฉ ุงููุทููุจุฉ"

**ุงูุญู:**
```python
# ุชุดุบูู setup_default_accounts
from financial.services.accounting_integration_service import AccountingIntegrationService
AccountingIntegrationService.setup_default_accounts()
```

### ุฎุทุฃ: "ูู ูุชู ุญุณุงุจ ุงูุชูููุฉ ุงูุฃุตููุฉ"

**ุงูุญู:**
```python
# ุงูุชุฃูุฏ ูู ุฃู ุงูููุชุฌุงุช ููุง cost_price
from product.models import Product
products_without_cost = Product.objects.filter(cost_price__isnull=True)
print(f"ุนุฏุฏ ุงูููุชุฌุงุช ุจุฏูู ุชูููุฉ: {products_without_cost.count()}")
```

### ุฎุทุฃ: "ูุดู ุฅูุดุงุก ุงูููุฏ ุงูุชุตุญูุญู"

**ุงูุญู:**
```python
# ุงูุชุญูู ูู ุงูุณุฌูุงุช
import logging
logger = logging.getLogger(__name__)
# ุฑุงุฌุน ุงูุณุฌูุงุช ูู console
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงููููุฏ ุงูุชุตุญูุญูุฉ ุชููุดุฃ ููุท ููููุงุชูุฑ ุงููุฑุญููุฉ**
   - ุฅุฐุง ูู ููู ููุงู ููุฏ ูุญุงุณุจูุ ูู ูุชู ุฅูุดุงุก ููุฏ ุชุตุญูุญู

2. **ุงููููุฏ ุงูุชุตุญูุญูุฉ ูุฑุญููุฉ ุชููุงุฆูุงู**
   - `status = 'posted'` ุฏุงุฆูุงู

3. **ุงูุชุงุฑูุฎ**
   - ุงูููุฏ ุงูุชุตุญูุญู ูุฃุฎุฐ ุชุงุฑูุฎ ุงูุชุนุฏูู (ุงูููู)
   - ูููุณ ุชุงุฑูุฎ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ

4. **ุงููุชุฑุฉ ุงููุญุงุณุจูุฉ**
   - ูุชู ุชุญุฏูุฏูุง ุชููุงุฆูุงู ุจูุงุกู ุนูู ุชุงุฑูุฎ ุงูุชุนุฏูู

5. **ุงููุณุชุฎุฏู**
   - ูุชู ุชุณุฌูู ุงููุณุชุฎุฏู ุงูุฐู ูุงู ุจุงูุชุนุฏูู ูู `created_by`

---

## ๐ฏ ูุนุงููุฑ ุงููุฌุงุญ

### โ ุงููุธุงู ูุนูู ุจุดูู ุตุญูุญ ุฅุฐุง:

1. **ุงููููุฏ ูุชูุงุฒูุฉ**
   - ูุฌููุน ุงููุฏูู = ูุฌููุน ุงูุฏุงุฆู ููู ููุฏ

2. **ุงููุฎุฒูู ูุชุทุงุจู**
   - ุญุฑูุงุช ุงููุฎุฒูู ุชุชุทุงุจู ูุน ุงููููุฏ ุงููุญุงุณุจูุฉ

3. **ุงูุฃุฑุตุฏุฉ ุตุญูุญุฉ**
   - ุฃุฑุตุฏุฉ ุงูุนููุงุก ูุงูููุฑุฏูู ุชุชุทุงุจู ูุน ุงููููุฏ

4. **ุงูุชูุงุฑูุฑ ุฏูููุฉ**
   - ุงูุฅูุฑุงุฏุงุช ูุงูุชูุงููู ุชุนูุณ ุงููุงูุน

5. **ุงูุฃุซุฑ ุงูุชุฏูููู ูุญููุธ**
   - ูููู ุชุชุจุน ุฌููุน ุงูุชุบููุฑุงุช

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-01-30  
**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-30  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ
