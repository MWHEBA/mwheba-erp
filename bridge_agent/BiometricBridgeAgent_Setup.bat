@echo off
title Biometric Bridge Agent - Installer
color 0B

echo ========================================
echo Biometric Bridge Agent Installer
echo ========================================
echo.

REM Check admin rights
net session >nul 2>&1
if errorlevel 1 (
    echo [ERROR] Administrator privileges required!
    echo.
    echo Please right-click this file and select:
    echo "Run as administrator"
    echo.
    pause
    exit /b 1
)

echo [OK] Running as Administrator
echo.

REM Set installation directory
set INSTALL_DIR=C:\BridgeAgent

echo Installation Directory: %INSTALL_DIR%
echo.

REM Create directory
if not exist "%INSTALL_DIR%" (
    echo Creating installation directory...
    mkdir "%INSTALL_DIR%"
)

REM Extract files
echo Extracting files...
echo.

REM This section will be replaced with actual file extraction
echo Extracting agent.py...
powershell -Command "$content = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('IiIiCkJpb21ldHJpYyBCcmlkZ2UgQWdlbnQK2YrYudmF2YQg2LnZhNmJINis2YfYp9iyINmF2K3ZhNmKINmI2YrYsdio2Lcg2KfZhNiz2YrYsdmB2LEg2KjZhdin2YPZitmG2Kkg2KfZhNio2LXZhdipINio2LTZg9mEINii2YXZhgoiIiIKaW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHRpbWUKaW1wb3J0IGpzb24KaW1wb3J0IGxvZ2dpbmcKaW1wb3J0IHJlcXVlc3RzCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gemsgaW1wb3J0IFpLCmltcG9ydCBzY2hlZHVsZQoKIyDYpdi52K/Yp9iv2KfYqgpDT05GSUdfRklMRSA9ICdjb25maWcuanNvbicKTE9HX0ZJTEUgPSAnYnJpZGdlX2FnZW50LmxvZycKCiMg2KXYudiv2KfYryDYp9mE2YAgTG9nZ2VyCmxvZ2dpbmcuYmFzaWNDb25maWcoCiAgICBsZXZlbD1sb2dnaW5nLklORk8sCiAgICBmb3JtYXQ9JyUoYXNjdGltZSlzIC0gJShsZXZlbG5hbWUpcyAtICUobWVzc2FnZSlzJywKICAgIGhhbmRsZXJzPVsKICAgICAgICBsb2dnaW5nLkZpbGVIYW5kbGVyKExPR19GSUxFLCBlbmNvZGluZz0ndXRmLTgnKSwKICAgICAgICBsb2dnaW5nLlN0cmVhbUhhbmRsZXIoKQogICAgXQopCmxvZ2dlciA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKF9fbmFtZV9fKQoKCmNsYXNzIEJpb21ldHJpY0JyaWRnZUFnZW50OgogICAgIiIi2YjZg9mK2YQg2KfZhNin2KrYtdin2YQg2KjZitmGINin2YTYs9mK2LHZgdixINmI2YXYp9mD2YrZhtipINin2YTYqNi12YXYqSIiIgogICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZmlnX3BhdGg9Q09ORklHX0ZJTEUpOgogICAgICAgICIiItiq2K3ZhdmK2YQg2KfZhNil2LnYr9in2K/Yp9iqIiIiCiAgICAgICAgc2VsZi5jb25maWcgPSBzZWxmLmxvYWRfY29uZmlnKGNvbmZpZ19wYXRoKQogICAgICAgIHNlbGYuZGV2aWNlX2lwID0gc2VsZi5jb25maWcuZ2V0KCdkZXZpY2VfaXAnKQogICAgICAgIHNlbGYuZGV2aWNlX3BvcnQgPSBzZWxmLmNvbmZpZy5nZXQoJ2RldmljZV9wb3J0JywgNDM3MCkKICAgICAgICBzZWxmLnNlcnZlcl91cmwgPSBzZWxmLmNvbmZpZy5nZXQoJ3NlcnZlcl91cmwnKQogICAgICAgIHNlbGYuYWdlbnRfY29kZSA9IHNlbGYuY29uZmlnLmdldCgnYWdlbnRfY29kZScpCiAgICAgICAgc2VsZi5hZ2VudF9zZWNyZXQgPSBzZWxmLmNvbmZpZy5nZXQoJ2FnZW50X3NlY3JldCcpCiAgICAgICAgc2VsZi5zeW5jX2ludGVydmFsID0gc2VsZi5jb25maWcuZ2V0KCdzeW5jX2ludGVydmFsJywgNSkgICMg2K/Zgtin2KbZggogICAgICAgIHNlbGYubGFzdF9zeW5jX3RpbWUgPSBOb25lCiAgICAgICAgCiAgICAgICAgbG9nZ2VyLmluZm8oZiJCcmlkZ2UgQWdlbnQgaW5pdGlhbGl6ZWQgLSBDb2RlOiB7c2VsZi5hZ2VudF9jb2RlfSIpCiAgICAKICAgIGRlZiBsb2FkX2NvbmZpZyhzZWxmLCBjb25maWdfcGF0aCk6CiAgICAgICAgIiIi2KrYrdmF2YrZhCDZhdmE2YEg2KfZhNil2LnYr9in2K/Yp9iqIiIiCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGNvbmZpZ19wYXRoKToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiQ29uZmlnIGZpbGUgbm90IGZvdW5kOiB7Y29uZmlnX3BhdGh9IikKICAgICAgICAgICAgc2VsZi5jcmVhdGVfZGVmYXVsdF9jb25maWcoY29uZmlnX3BhdGgpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQ3JlYXRlZCBkZWZhdWx0IGNvbmZpZyBmaWxlLiBQbGVhc2UgZWRpdDoge2NvbmZpZ19wYXRofSIpCiAgICAgICAgICAgIHN5cy5leGl0KDEpCiAgICAgICAgCiAgICAgICAgd2l0aCBvcGVuKGNvbmZpZ19wYXRoLCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICAgICAgICAgIHJldHVybiBqc29uLmxvYWQoZikKICAgIAogICAgZGVmIGNyZWF0ZV9kZWZhdWx0X2NvbmZpZyhzZWxmLCBjb25maWdfcGF0aCk6CiAgICAgICAgIiIi2KXZhti02KfYoSDZhdmE2YEg2KXYudiv2KfYr9in2Kog2KfZgdiq2LHYp9i22YoiIiIKICAgICAgICBkZWZhdWx0X2NvbmZpZyA9IHsKICAgICAgICAgICAgImRldmljZV9pcCI6ICIxOTIuMTY4LjEuMTAwIiwKICAgICAgICAgICAgImRldmljZV9wb3J0IjogNDM3MCwKICAgICAgICAgICAgInNlcnZlcl91cmwiOiAiaHR0cHM6Ly95b3Vyc2l0ZS5jb20iLAogICAgICAgICAgICAiYWdlbnRfY29kZSI6ICJBR0VOVC0wMDEiLAogICAgICAgICAgICAiYWdlbnRfc2VjcmV0IjogInlvdXItc2VjcmV0LWtleS1oZXJlIiwKICAgICAgICAgICAgInN5bmNfaW50ZXJ2YWwiOiA1LAogICAgICAgICAgICAiYXV0b19kaXNjb3Zlcl9pcCI6IFRydWUKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgd2l0aCBvcGVuKGNvbmZpZ19wYXRoLCAndycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChkZWZhdWx0X2NvbmZpZywgZiwgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgIAogICAgZGVmIGRpc2NvdmVyX2RldmljZV9pcChzZWxmKToKICAgICAgICAiIiIKICAgICAgICDYp9mD2KrYtNin2YEgSVAg2KfZhNmF2KfZg9mK2YbYqSDYqtmE2YLYp9im2YrYp9mLINmB2Yog2KfZhNi02KjZg9ipINin2YTZhdit2YTZitipCiAgICAgICAg2YrYqNit2Ksg2YHZiiDZhti32KfZgiAxOTIuMTY4LjEuMSAtIDE5Mi4xNjguMS4yNTQKICAgICAgICAiIiIKICAgICAgICBsb2dnZXIuaW5mbygiU2VhcmNoaW5nIGZvciBaS1RlY28gZGV2aWNlIGluIGxvY2FsIG5ldHdvcmsuLi4iKQogICAgICAgIAogICAgICAgIGltcG9ydCBzb2NrZXQKICAgICAgICBmcm9tIGNvbmN1cnJlbnQuZnV0dXJlcyBpbXBvcnQgVGhyZWFkUG9vbEV4ZWN1dG9yLCBhc19jb21wbGV0ZWQKICAgICAgICAKICAgICAgICBkZWYgY2hlY2tfaXAoaXApOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICAgICAgc29jay5zZXR0aW1lb3V0KDAuNSkKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNvY2suY29ubmVjdF9leCgoaXAsIHNlbGYuZGV2aWNlX3BvcnQpKQogICAgICAgICAgICAgICAgc29jay5jbG9zZSgpCiAgICAgICAgICAgICAgICBpZiByZXN1bHQgPT0gMDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXAKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIAogICAgICAgICMg2KfZhNio2K3YqyDZgdmKINin2YTYtNio2YPYqSDYp9mE2YXYrdmE2YrYqQogICAgICAgIGJhc2VfaXAgPSAiMTkyLjE2OC4xLiIKICAgICAgICBpcHNfdG9fY2hlY2sgPSBbZiJ7YmFzZV9pcH17aX0iIGZvciBpIGluIHJhbmdlKDEsIDI1NSldCiAgICAgICAgCiAgICAgICAgd2l0aCBUaHJlYWRQb29sRXhlY3V0b3IobWF4X3dvcmtlcnM9NTApIGFzIGV4ZWN1dG9yOgogICAgICAgICAgICBmdXR1cmVzID0ge2V4ZWN1dG9yLnN1Ym1pdChjaGVja19pcCwgaXApOiBpcCBmb3IgaXAgaW4gaXBzX3RvX2NoZWNrfQogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIGZ1dHVyZSBpbiBhc19jb21wbGV0ZWQoZnV0dXJlcyk6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBmdXR1cmUucmVzdWx0KCkKICAgICAgICAgICAgICAgIGlmIHJlc3VsdDoKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkZvdW5kIGRldmljZSBhdDoge3Jlc3VsdH0iKQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAKICAgICAgICBsb2dnZXIud2FybmluZygiTm8gZGV2aWNlIGZvdW5kIGluIG5ldHdvcmsiKQogICAgICAgIHJldHVybiBOb25lCiAgICAKICAgIGRlZiB0ZXN0X2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgIiIi2KfYrtiq2KjYp9ixINin2YTYp9iq2LXYp9mEINio2KfZhNmF2KfZg9mK2YbYqSIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJUZXN0aW5nIGNvbm5lY3Rpb24gdG8ge3NlbGYuZGV2aWNlX2lwfTp7c2VsZi5kZXZpY2VfcG9ydH0iKQogICAgICAgICAgICAKICAgICAgICAgICAgY29ubiA9IFpLKHNlbGYuZGV2aWNlX2lwLCBwb3J0PXNlbGYuZGV2aWNlX3BvcnQsIHRpbWVvdXQ9NSkKICAgICAgICAgICAgemsgPSBjb25uLmNvbm5lY3QoKQogICAgICAgICAgICAKICAgICAgICAgICAgZGV2aWNlX25hbWUgPSB6ay5nZXRfZGV2aWNlX25hbWUoKQogICAgICAgICAgICBmaXJtd2FyZSA9IHprLmdldF9maXJtd2FyZV92ZXJzaW9uKCkKICAgICAgICAgICAgdXNlcnNfY291bnQgPSBsZW4oemsuZ2V0X3VzZXJzKCkpCiAgICAgICAgICAgIAogICAgICAgICAgICB6ay5kaXNjb25uZWN0KCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYi4pyTIENvbm5lY3RlZCBzdWNjZXNzZnVsbHkhIikKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiIgIERldmljZToge2RldmljZV9uYW1lfSIpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiICBGaXJtd2FyZToge2Zpcm13YXJlfSIpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiICBVc2Vyczoge3VzZXJzX2NvdW50fSIpCiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIuKclyBDb25uZWN0aW9uIGZhaWxlZDoge2V9IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAKICAgIGRlZiBnZXRfYXR0ZW5kYW5jZV9yZWNvcmRzKHNlbGYsIGZyb21fdGltZXN0YW1wPU5vbmUpOgogICAgICAgICIiItis2YTYqCDYs9is2YTYp9iqINin2YTYrdi22YjYsSDZhdmGINin2YTZhdin2YPZitmG2KkiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNvbm4gPSBaSyhzZWxmLmRldmljZV9pcCwgcG9ydD1zZWxmLmRldmljZV9wb3J0LCB0aW1lb3V0PTUpCiAgICAgICAgICAgIHprID0gY29ubi5jb25uZWN0KCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGF0dGVuZGFuY2VzID0gemsuZ2V0X2F0dGVuZGFuY2UoKQogICAgICAgICAgICAKICAgICAgICAgICAgIyDYqtit2YjZitmEINmE2YTZgCBKU09OCiAgICAgICAgICAgIHJlY29yZHMgPSBbXQogICAgICAgICAgICBmb3IgYXR0IGluIGF0dGVuZGFuY2VzOgogICAgICAgICAgICAgICAgIyDZgdmE2KrYsdipINit2LPYqCDYp9mE2YjZgtiqINil2LDYpyDYqtmFINiq2K3Yr9mK2K/ZhwogICAgICAgICAgICAgICAgaWYgZnJvbV90aW1lc3RhbXAgYW5kIGF0dC50aW1lc3RhbXAgPCBmcm9tX3RpbWVzdGFtcDoKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZWNvcmRzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAgJ3VzZXJfaWQnOiBzdHIoYXR0LnVzZXJfaWQpLAogICAgICAgICAgICAgICAgICAgICd0aW1lc3RhbXAnOiBhdHQudGltZXN0YW1wLmlzb2Zvcm1hdCgpLAogICAgICAgICAgICAgICAgICAgICdzdGF0dXMnOiBhdHQuc3RhdHVzIGlmIGhhc2F0dHIoYXR0LCAnc3RhdHVzJykgZWxzZSAwLAogICAgICAgICAgICAgICAgICAgICdwdW5jaCc6IGF0dC5wdW5jaCBpZiBoYXNhdHRyKGF0dCwgJ3B1bmNoJykgZWxzZSAwCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgemsuZGlzY29ubmVjdCgpCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkZldGNoZWQge2xlbihyZWNvcmRzKX0gcmVjb3JkcyBmcm9tIGRldmljZSIpCiAgICAgICAgICAgIHJldHVybiByZWNvcmRzCiAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgZmV0Y2hpbmcgcmVjb3Jkczoge2V9IikKICAgICAgICAgICAgcmV0dXJuIFtdCiAgICAKICAgIGRlZiBzZW5kX3RvX3NlcnZlcihzZWxmLCByZWNvcmRzKToKICAgICAgICAiIiLYpdix2LPYp9mEINin2YTYs9is2YTYp9iqINmE2YTYs9mK2LHZgdixIiIiCiAgICAgICAgaWYgbm90IHJlY29yZHM6CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJObyBuZXcgcmVjb3JkcyB0byBzZW5kIikKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAKICAgICAgICB0cnk6CiAgICAgICAgICAgIGFwaV91cmwgPSBmIntzZWxmLnNlcnZlcl91cmx9L2FwaS9iaW9tZXRyaWMvYnJpZGdlLXN5bmMvIgogICAgICAgICAgICAKICAgICAgICAgICAgcGF5bG9hZCA9IHsKICAgICAgICAgICAgICAgICdhZ2VudF9jb2RlJzogc2VsZi5hZ2VudF9jb2RlLAogICAgICAgICAgICAgICAgJ3JlY29yZHMnOiByZWNvcmRzLAogICAgICAgICAgICAgICAgJ3RpbWVzdGFtcCc6IGRhdGV0aW1lLm5vdygpLmlzb2Zvcm1hdCgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGYnQmVhcmVyIHtzZWxmLmFnZW50X3NlY3JldH0nLAogICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIlNlbmRpbmcge2xlbihyZWNvcmRzKX0gcmVjb3JkcyB0byBzZXJ2ZXIuLi4iKQogICAgICAgICAgICAKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KAogICAgICAgICAgICAgICAgYXBpX3VybCwKICAgICAgICAgICAgICAgIGpzb249cGF5bG9hZCwKICAgICAgICAgICAgICAgIGhlYWRlcnM9aGVhZGVycywKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MzAKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbyhmIuKckyBTZXJ2ZXIgcmVzcG9uc2U6IHtyZXN1bHQuZ2V0KCdtZXNzYWdlJyl9IikKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiICBQcm9jZXNzZWQ6IHtyZXN1bHQuZ2V0KCdwcm9jZXNzZWQnLCAwKX0iKQogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiIgIFNraXBwZWQ6IHtyZXN1bHQuZ2V0KCdza2lwcGVkJywgMCl9IikKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiLinJcgU2VydmVyIGVycm9yOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9IikKICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIiAgUmVzcG9uc2U6IHtyZXNwb25zZS50ZXh0fSIpCiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3Igc2VuZGluZyB0byBzZXJ2ZXI6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgCiAgICBkZWYgc3luY19ub3coc2VsZik6CiAgICAgICAgIiIi2KrZhtmB2YrYsCDYp9mE2YXYstin2YXZhtipINin2YTYotmGIiIiCiAgICAgICAgbG9nZ2VyLmluZm8oIj0iICogNjApCiAgICAgICAgbG9nZ2VyLmluZm8oIlN0YXJ0aW5nIHN5bmMgY3ljbGUuLi4iKQogICAgICAgIAogICAgICAgIHRyeToKICAgICAgICAgICAgIyDYrNmE2Kgg2KfZhNiz2KzZhNin2Kog2YXZhiDYp9mE2YXYp9mD2YrZhtipCiAgICAgICAgICAgIHJlY29yZHMgPSBzZWxmLmdldF9hdHRlbmRhbmNlX3JlY29yZHMoc2VsZi5sYXN0X3N5bmNfdGltZSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMg2KXYsdiz2KfZhCDZhNmE2LPZitix2YHYsQogICAgICAgICAgICBpZiByZWNvcmRzOgogICAgICAgICAgICAgICAgc3VjY2VzcyA9IHNlbGYuc2VuZF90b19zZXJ2ZXIocmVjb3JkcykKICAgICAgICAgICAgICAgIGlmIHN1Y2Nlc3M6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5sYXN0X3N5bmNfdGltZSA9IGRhdGV0aW1lLm5vdygpCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiLinJMgU3luYyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoIuKclyBTeW5jIGZhaWxlZCAtIHdpbGwgcmV0cnkgbmV4dCBjeWNsZSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiTm8gbmV3IHJlY29yZHMgdG8gc3luYyIpCiAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiU3luYyBlcnJvcjoge2V9IikKICAgICAgICAKICAgICAgICBsb2dnZXIuaW5mbygiPSIgKiA2MCkKICAgIAogICAgZGVmIHJ1bihzZWxmKToKICAgICAgICAiIiLYqti02LrZitmEINin2YTZiNmD2YrZhCIiIgogICAgICAgIGxvZ2dlci5pbmZvKCI9IiAqIDYwKQogICAgICAgIGxvZ2dlci5pbmZvKCJCaW9tZXRyaWMgQnJpZGdlIEFnZW50IFN0YXJ0ZWQiKQogICAgICAgIGxvZ2dlci5pbmZvKGYiQWdlbnQgQ29kZToge3NlbGYuYWdlbnRfY29kZX0iKQogICAgICAgIGxvZ2dlci5pbmZvKGYiRGV2aWNlOiB7c2VsZi5kZXZpY2VfaXB9OntzZWxmLmRldmljZV9wb3J0fSIpCiAgICAgICAgbG9nZ2VyLmluZm8oZiJTZXJ2ZXI6IHtzZWxmLnNlcnZlcl91cmx9IikKICAgICAgICBsb2dnZXIuaW5mbyhmIlN5bmMgSW50ZXJ2YWw6IHtzZWxmLnN5bmNfaW50ZXJ2YWx9IG1pbnV0ZXMiKQogICAgICAgIGxvZ2dlci5pbmZvKCI9IiAqIDYwKQogICAgICAgIAogICAgICAgICMg2KfYrtiq2KjYp9ixINin2YTYp9iq2LXYp9mEINio2KfZhNmF2KfZg9mK2YbYqQogICAgICAgIGlmIG5vdCBzZWxmLnRlc3RfY29ubmVjdGlvbigpOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIkNhbm5vdCBjb25uZWN0IHRvIGRldmljZS4gUGxlYXNlIGNoZWNrIGNvbmZpZ3VyYXRpb24uIikKICAgICAgICAgICAgCiAgICAgICAgICAgICMg2YXYrdin2YjZhNipINin2YPYqti02KfZgSBJUCDYqtmE2YLYp9im2YrYp9mLCiAgICAgICAgICAgIGlmIHNlbGYuY29uZmlnLmdldCgnYXV0b19kaXNjb3Zlcl9pcCcsIEZhbHNlKToKICAgICAgICAgICAgICAgIGRpc2NvdmVyZWRfaXAgPSBzZWxmLmRpc2NvdmVyX2RldmljZV9pcCgpCiAgICAgICAgICAgICAgICBpZiBkaXNjb3ZlcmVkX2lwOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZGV2aWNlX2lwID0gZGlzY292ZXJlZF9pcAogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiVXBkYXRlZCBkZXZpY2UgSVAgdG86IHtkaXNjb3ZlcmVkX2lwfSIpCiAgICAgICAgICAgICAgICAgICAgIyDYrdmB2Lgg2YHZiiDYp9mE2KXYudiv2KfYr9in2KoKICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1snZGV2aWNlX2lwJ10gPSBkaXNjb3ZlcmVkX2lwCiAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuKENPTkZJR19GSUxFLCAndycsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICAgICAgICAgICAgICAgICAgICAgIGpzb24uZHVtcChzZWxmLmNvbmZpZywgZiwgaW5kZW50PTQsIGVuc3VyZV9hc2NpaT1GYWxzZSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJBdXRvLWRpc2NvdmVyeSBmYWlsZWQuIEV4aXRpbmcuLi4iKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgICMg2YXYstin2YXZhtipINmB2YjYsdmK2Kkg2LnZhtivINin2YTYqNiv2KEKICAgICAgICBzZWxmLnN5bmNfbm93KCkKICAgICAgICAKICAgICAgICAjINis2K/ZiNmE2Kkg2KfZhNmF2LLYp9mF2YbYqSDYp9mE2K/ZiNix2YrYqQogICAgICAgIHNjaGVkdWxlLmV2ZXJ5KHNlbGYuc3luY19pbnRlcnZhbCkubWludXRlcy5kbyhzZWxmLnN5bmNfbm93KQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYiU2NoZWR1bGVkIHN5bmMgZXZlcnkge3NlbGYuc3luY19pbnRlcnZhbH0gbWludXRlcyIpCiAgICAgICAgbG9nZ2VyLmluZm8oIlByZXNzIEN0cmwrQyB0byBzdG9wIikKICAgICAgICAKICAgICAgICAjINit2YTZgtipINin2YTYqti02LrZitmEINin2YTYsdim2YrYs9mK2KkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBzY2hlZHVsZS5ydW5fcGVuZGluZygpCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBsb2dnZXIuaW5mbygiXG5TaHV0dGluZyBkb3duIGdyYWNlZnVsbHkuLi4iKQogICAgICAgICAgICBsb2dnZXIuaW5mbygiQnJpZGdlIEFnZW50IHN0b3BwZWQiKQoKCmRlZiBtYWluKCk6CiAgICAiIiLZhtmC2LfYqSDYp9mE2KjYr9in2YrYqSIiIgogICAgdHJ5OgogICAgICAgIHByaW50KCIiIgogICAgICAgIOKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVlwogICAgICAgIOKVkSAgICAgICAgIEJpb21ldHJpYyBCcmlkZ2UgQWdlbnQgdjEuMCAgICAgICAgICAgICAgICAgICAgICDilZEKICAgICAgICDilZEgICAgICAgICBTZWN1cmUgY29ubmVjdGlvbiBiZXR3ZWVuIFpLVGVjbyAmIFNlcnZlciAgICAgICAg4pWRCiAgICAgICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdCiAgICAgICAgIiIiKQogICAgZXhjZXB0IFVuaWNvZGVFbmNvZGVFcnJvcjoKICAgICAgICAjIEZhbGxiYWNrIGZvciBXaW5kb3dzIFNlcnZpY2UgY29uc29sZSBlbmNvZGluZyBpc3N1ZXMKICAgICAgICBwcmludCgiPSIgKiA2MCkKICAgICAgICBwcmludCgiICAgIEJpb21ldHJpYyBCcmlkZ2UgQWdlbnQgdjEuMCIpCiAgICAgICAgcHJpbnQoIiAgICBTZWN1cmUgY29ubmVjdGlvbiBiZXR3ZWVuIFpLVGVjbyAmIFNlcnZlciIpCiAgICAgICAgcHJpbnQoIj0iICogNjApCiAgICAKICAgIGFnZW50ID0gQmlvbWV0cmljQnJpZGdlQWdlbnQoKQogICAgYWdlbnQucnVuKCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg==')); $Utf8NoBom = New-Object System.Text.UTF8Encoding $False; [System.IO.File]::WriteAllText('%INSTALL_DIR%\agent.py', $content, $Utf8NoBom)"
echo Extracting requirements.txt...
powershell -Command "$content = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('cHl6az09MC45CnJlcXVlc3RzPT0yLjMxLjAKc2NoZWR1bGU9PTEuMi4wCg==')); $Utf8NoBom = New-Object System.Text.UTF8Encoding $False; [System.IO.File]::WriteAllText('%INSTALL_DIR%\requirements.txt', $content, $Utf8NoBom)"
echo Extracting config.json...
powershell -Command "$content = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('ewogICAgImRldmljZV9pcCI6ICIxOTIuMTY4LjEuMjAxIiwKICAgICJkZXZpY2VfcG9ydCI6IDQzNzAsCiAgICAic2VydmVyX3VybCI6ICJodHRwOi8vMTI3LjAuMC4xOjgwMDAiLAogICAgImFnZW50X2NvZGUiOiAiWktUZWNvIiwKICAgICJhZ2VudF9zZWNyZXQiOiAiemt0ZWNvLXNlY3JldC1rZXktMjAyNSIsCiAgICAic3luY19pbnRlcnZhbCI6IDUsCiAgICAiYXV0b19kaXNjb3Zlcl9pcCI6IHRydWUsCiAgICAiY29tbWVudHMiOiB7CiAgICAgICAgImRldmljZV9pcCI6ICJJUCBhZGRyZXNzIG9mIFpLVGVjbyBkZXZpY2UgaW4gbG9jYWwgbmV0d29yayIsCiAgICAgICAgImRldmljZV9wb3J0IjogIlBvcnQgbnVtYmVyIChkZWZhdWx0OiA0MzcwKSIsCiAgICAgICAgInNlcnZlcl91cmwiOiAiWW91ciBwcm9kdWN0aW9uIHNlcnZlciBVUkwgKHdpdGhvdXQgdHJhaWxpbmcgc2xhc2gpIiwKICAgICAgICAiYWdlbnRfY29kZSI6ICJVbmlxdWUgY29kZSBmb3IgdGhpcyBhZ2VudCAod2lsbCBiZSByZWdpc3RlcmVkIGluIHNlcnZlcikiLAogICAgICAgICJhZ2VudF9zZWNyZXQiOiAiU2VjcmV0IGtleSBmb3IgYXV0aGVudGljYXRpb24gKGtlZXAgaXQgc2FmZSEpIiwKICAgICAgICAic3luY19pbnRlcnZhbCI6ICJTeW5jIGludGVydmFsIGluIG1pbnV0ZXMgKGRlZmF1bHQ6IDUpIiwKICAgICAgICAiYXV0b19kaXNjb3Zlcl9pcCI6ICJBdXRvLWRpc2NvdmVyIGRldmljZSBJUCBpZiBjb25uZWN0aW9uIGZhaWxzIgogICAgfQp9Cg==')); $Utf8NoBom = New-Object System.Text.UTF8Encoding $False; [System.IO.File]::WriteAllText('%INSTALL_DIR%\config.json', $content, $Utf8NoBom)"
echo Extracting README.md...
powershell -Command "$content = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('IyBCaW9tZXRyaWMgQnJpZGdlIEFnZW50CgrZiNmD2YrZhCDYotmF2YYg2YrYsdio2Lcg2YXYp9mD2YrZhtipINin2YTYqNi12YXYqSBaS1RlY28g2KjYp9mE2LPZitix2YHYsSAtINmK2LnZhdmEINmD2K7Yr9mF2Kkg2YjZitmG2K/ZiNiyINmB2Yog2KfZhNiu2YTZgdmK2KkKCiMjINin2YTYqtir2KjZitiqINin2YTYqtmE2YLYp9im2YogKDMg2K7Yt9mI2KfYqiDZgdmC2LchKQoKIyMjIDEuINiq2K3ZhdmK2YQgQnJpZGdlIEFnZW50Ci0g2K3ZhdmR2YQg2KfZhNmF2YTZgSDZhdmGINin2YTZhti42KfZhSAo2LXZgdit2Kkg2KfZhNis2YfYp9iyIOKGkiDYpdi52K/Yp9ivIEJyaWRnZSBBZ2VudCkKLSDYp9iz2KrYrtix2Kwg2KfZhNmF2YTZgdin2Kog2YHZiiDZhdmD2KfZhiDYq9in2KjYqiAo2YXYq9mE2KfZizogYEM6XEJyaWRnZUFnZW50YCkKCiMjIyAyLiDYqtir2KjZitiqINmD2K7Yr9mF2Kkg2YjZitmG2K/ZiNiyCmBgYGJhc2gKIyDZg9mE2YrZgyDZitmF2YrZhiDYudmE2YkgaW5zdGFsbF9zZXJ2aWNlLmJhdCDihpIgUnVuIGFzIGFkbWluaXN0cmF0b3IKaW5zdGFsbF9zZXJ2aWNlLmJhdApgYGAKCioq2KfZhNiz2YPYsdmK2KjYqiDYs9mK2YLZiNmFINio2YPZhCDYtNmK2KEg2KrZhNmC2KfYptmK2KfZizoqKgotIOKchSDYqtit2YXZitmEINmI2KrYq9io2YrYqiBOU1NNICjYo9iv2KfYqSDYp9mE2K7Yr9mF2KkpCi0g4pyFINin2YTYqtit2YLZgiDZhdmGIFB5dGhvbiDZiNiq2KvYqNmK2Kog2KfZhNmF2YPYqtio2KfYqiDYp9mE2YXYt9mE2YjYqNipCi0g4pyFINiq2KvYqNmK2Kog2YjYqti02LrZitmEINin2YTYrtiv2YXYqQotIOKchSDYttio2Lcg2KfZhNiq2LTYutmK2YQg2KfZhNiq2YTZgtin2KbZiiDZhdi5INin2YTZiNmK2YbYr9mI2LIKCiMjIyAzLiDYqtmFISDwn46JCtin2YTYrtiv2YXYqSDYp9mE2KLZhiDYqti52YXZhCDZgdmKINin2YTYrtmE2YHZitipINmI2KrYstin2YXZhiDYp9mE2KjZitin2YbYp9iqINmD2YQgNSDYr9mC2KfYptmCCgotLS0KCiMjINij2YjYp9mF2LEg2KXYr9in2LHYqSDYp9mE2K7Yr9mF2KkKCmBgYGJhc2gKIyDYqti02LrZitmEINin2YTYrtiv2YXYqQpuc3NtIHN0YXJ0IEJpb21ldHJpY0JyaWRnZQoKIyDYpdmK2YLYp9mBINin2YTYrtiv2YXYqQpuc3NtIHN0b3AgQmlvbWV0cmljQnJpZGdlCgojINil2LnYp9iv2Kkg2KrYtNi62YrZhCDYp9mE2K7Yr9mF2KkKbnNzbSByZXN0YXJ0IEJpb21ldHJpY0JyaWRnZQoKIyDYrdin2YTYqSDYp9mE2K7Yr9mF2KkKbnNzbSBzdGF0dXMgQmlvbWV0cmljQnJpZGdlCgojINil2YTYutin2KEg2KrYq9io2YrYqiDYp9mE2K7Yr9mF2KkKdW5pbnN0YWxsX3NlcnZpY2UuYmF0CmBgYAoKLS0tCgojIyDZhdmE2YHYp9iqINin2YTYs9is2YTYp9iqCgpgYGAKQzpcQnJpZGdlQWdlbnRcCuKUnOKUgOKUgCBzZXJ2aWNlLmxvZyAgICAgICAgICDihpAg2LPYrNmEINin2YTYqti02LrZitmECuKUnOKUgOKUgCBzZXJ2aWNlX2Vycm9yLmxvZyAgICDihpAg2LPYrNmEINin2YTYo9iu2LfYp9ihCuKUlOKUgOKUgCBicmlkZ2VfYWdlbnQubG9nICAgICDihpAg2LPYrNmEINin2YTZhdiy2KfZhdmG2KkKYGBgCgotLS0KCiMjINin2YTYpdi52K/Yp9iv2KfYqiDYudmE2Ykg2KfZhNiz2YrYsdmB2LEKCmBgYHB5dGhvbgojINmB2YogLmVudgpCUklER0VfQUdFTlRTPUFHRU5ULTAwMTp5b3VyLXNlY3JldC1rZXktaGVyZQoKIyDYo9mIINmB2Yogc2V0dGluZ3MucHkKQlJJREdFX0FHRU5UUyA9IHsKICAgICdBR0VOVC0wMDEnOiAneW91ci1zZWNyZXQta2V5LWhlcmUnCn0KYGBgCgotLS0KCiMjINin2YTZhdiq2LfZhNio2KfYqgoKLSDinIUgV2luZG93cyA3INij2Ygg2KPYrdiv2KsKLSDinIUgUHl0aG9uIDMuOCDYo9mIINij2K3Yr9irICjZitiq2YUg2KfZhNiq2K3ZgtmCINiq2YTZgtin2KbZitin2YspCi0g4pyFINin2KrYtdin2YQg2KjYp9mE2KXZhtiq2LHZhtiqICjZhNmE2KrYq9io2YrYqiDZgdmC2LcpCi0g4pyFINi12YTYp9it2YrYp9iqIEFkbWluaXN0cmF0b3IgKNmE2YTYqtir2KjZitiqINmB2YLYtykKCi0tLQoKIyMg2KfZhNmF2YPYqtio2KfYqiDYp9mE2YXYs9iq2K7Yr9mF2KkKCi0gYHB5emtgIC0g2YTZhNin2KrYtdin2YQg2KjYo9is2YfYstipIFpLVGVjbwotIGByZXF1ZXN0c2AgLSDZhNmE2KfYqti12KfZhCDYqNin2YTYs9mK2LHZgdixCi0gYHNjaGVkdWxlYCAtINmE2KzYr9mI2YTYqSDYp9mE2YXYstin2YXZhtipCgotLS0KCiMjINin2YTYo9mF2KfZhgoKLSDwn5SSINmF2YHYp9iq2YrYrSDYs9ix2YrYqSDZhdi02YHYsdipCi0g8J+UkiDYp9iq2LXYp9mEIEhUVFBTINmF2Lkg2KfZhNiz2YrYsdmB2LEKLSDwn5SSINin2YTYqtit2YLZgiDZhdmGINi12K3YqSDYp9mE2KjZitin2YbYp9iqCi0g8J+UkiDYs9is2YTYp9iqINmF2YHYtdmE2Kkg2YTZhNmF2LHYp9is2LnYqQo=')); $Utf8NoBom = New-Object System.Text.UTF8Encoding $False; [System.IO.File]::WriteAllText('%INSTALL_DIR%\README.md', $content, $Utf8NoBom)"
echo Extracting install_service.bat...
powershell -Command "$content = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('QGVjaG8gb2ZmCnRpdGxlIEJyaWRnZSBBZ2VudCAtIFNlcnZpY2UgSW5zdGFsbGVyCmVjaG8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQplY2hvIEluc3RhbGxpbmcgYXMgV2luZG93cyBTZXJ2aWNlCmVjaG8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQplY2hvLgoKUkVNIENoZWNrIGFkbWluIHJpZ2h0cwpuZXQgc2Vzc2lvbiA+bnVsIDI+JjEKaWYgZXJyb3JsZXZlbCAxICgKICAgIGVjaG8uCiAgICBlY2hvIFtFUlJPUl0gUGxlYXNlIHJ1biBhcyBBZG1pbmlzdHJhdG9yIQogICAgZWNoby4KICAgIGVjaG8gUmlnaHQtY2xpY2sgb24gdGhpcyBmaWxlIGFuZCBzZWxlY3QgIlJ1biBhcyBhZG1pbmlzdHJhdG9yIgogICAgZWNoby4KICAgIHBhdXNlCiAgICBleGl0IC9iIDEKKQoKZWNobyBbMS80XSBDaGVja2luZyBOU1NNLi4uCmVjaG8uCgpSRU0gRG93bmxvYWQgTlNTTSBpZiBub3QgZXhpc3RzCmlmIG5vdCBleGlzdCAibnNzbS5leGUiICgKICAgIGVjaG8gTlNTTSBub3QgZm91bmQuIERvd25sb2FkaW5nLi4uCiAgICBlY2hvLgogICAgZWNobyBUaGlzIG1heSB0YWtlIGEgZmV3IG1vbWVudHMuLi4KICAgIGVjaG8uCiAgICAKICAgIFJFTSBEb3dubG9hZCB1c2luZyBQb3dlclNoZWxsIHdpdGggcHJvZ3Jlc3MKICAgIHBvd2Vyc2hlbGwgLUV4ZWN1dGlvblBvbGljeSBCeXBhc3MgLUNvbW1hbmQgInRyeSB7ICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZSc7IEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgJ2h0dHBzOi8vbnNzbS5jYy9jaS9uc3NtLTIuMjQtMTAxLWc4OTdjN2FkLnppcCcgLU91dEZpbGUgJ25zc20uemlwJyAtVXNlQmFzaWNQYXJzaW5nOyBleGl0IDAgfSBjYXRjaCB7IFdyaXRlLUhvc3QgJF8uRXhjZXB0aW9uLk1lc3NhZ2U7IGV4aXQgMSB9IgogICAgCiAgICBpZiBlcnJvcmxldmVsIDEgKAogICAgICAgIGVjaG8uCiAgICAgICAgZWNobyBbRVJST1JdIEZhaWxlZCB0byBkb3dubG9hZCBOU1NNIGF1dG9tYXRpY2FsbHkuCiAgICAgICAgZWNoby4KICAgICAgICBlY2hvIFBsZWFzZToKICAgICAgICBlY2hvIDEuIERvd25sb2FkIE5TU00gZnJvbTogaHR0cHM6Ly9uc3NtLmNjL2Rvd25sb2FkCiAgICAgICAgZWNobyAyLiBFeHRyYWN0IG5zc20uZXhlIGZyb20gd2luNjQgZm9sZGVyCiAgICAgICAgZWNobyAzLiBDb3B5IG5zc20uZXhlIHRvIHRoaXMgZm9sZGVyCiAgICAgICAgZWNobyA0LiBSdW4gdGhpcyBzY3JpcHQgYWdhaW4KICAgICAgICBlY2hvLgogICAgICAgIHBhdXNlCiAgICAgICAgZXhpdCAvYiAxCiAgICApCiAgICAKICAgIGlmIG5vdCBleGlzdCAibnNzbS56aXAiICgKICAgICAgICBlY2hvLgogICAgICAgIGVjaG8gW0VSUk9SXSBEb3dubG9hZCBmYWlsZWQgLSBuc3NtLnppcCBub3QgZm91bmQKICAgICAgICBlY2hvLgogICAgICAgIHBhdXNlCiAgICAgICAgZXhpdCAvYiAxCiAgICApCiAgICAKICAgIGVjaG8gWzIvNF0gRXh0cmFjdGluZyBOU1NNLi4uCiAgICBwb3dlcnNoZWxsIC1FeGVjdXRpb25Qb2xpY3kgQnlwYXNzIC1Db21tYW5kICJ0cnkgeyBFeHBhbmQtQXJjaGl2ZSAtUGF0aCAnbnNzbS56aXAnIC1EZXN0aW5hdGlvblBhdGggJy4nIC1Gb3JjZTsgZXhpdCAwIH0gY2F0Y2ggeyBXcml0ZS1Ib3N0ICRfLkV4Y2VwdGlvbi5NZXNzYWdlOyBleGl0IDEgfSIKICAgIAogICAgaWYgZXJyb3JsZXZlbCAxICgKICAgICAgICBlY2hvLgogICAgICAgIGVjaG8gW0VSUk9SXSBGYWlsZWQgdG8gZXh0cmFjdCBOU1NNCiAgICAgICAgZWNoby4KICAgICAgICBwYXVzZQogICAgICAgIGV4aXQgL2IgMQogICAgKQogICAgCiAgICBSRU0gQ29weSBuc3NtLmV4ZSBmcm9tIGV4dHJhY3RlZCBmb2xkZXIKICAgIGlmIGV4aXN0ICJuc3NtLTIuMjQtMTAxLWc4OTdjN2FkXHdpbjY0XG5zc20uZXhlIiAoCiAgICAgICAgY29weSAibnNzbS0yLjI0LTEwMS1nODk3YzdhZFx3aW42NFxuc3NtLmV4ZSIgIm5zc20uZXhlIiA+bnVsCiAgICAgICAgZWNobyBOU1NNIGV4dHJhY3RlZCBzdWNjZXNzZnVsbHkhCiAgICAgICAgZWNoby4KICAgICkgZWxzZSAoCiAgICAgICAgZWNoby4KICAgICAgICBlY2hvIFtFUlJPUl0gQ291bGQgbm90IGZpbmQgbnNzbS5leGUgaW4gZXh0cmFjdGVkIGZpbGVzCiAgICAgICAgZWNoby4KICAgICAgICBkaXIgL3MgL2IgbnNzbSouZXhlCiAgICAgICAgZWNoby4KICAgICAgICBwYXVzZQogICAgICAgIGV4aXQgL2IgMQogICAgKQogICAgCiAgICBSRU0gQ2xlYW51cAogICAgaWYgZXhpc3QgIm5zc20uemlwIiBkZWwgbnNzbS56aXAKICAgIGlmIGV4aXN0ICJuc3NtLTIuMjQtMTAxLWc4OTdjN2FkIiBybWRpciAvcyAvcSBuc3NtLTIuMjQtMTAxLWc4OTdjN2FkCiAgICAKKSBlbHNlICgKICAgIGVjaG8gTlNTTSBhbHJlYWR5IGV4aXN0cy4gU2tpcHBpbmcgZG93bmxvYWQuCiAgICBlY2hvLgopCgplY2hvIFszLzRdIENoZWNraW5nIFB5dGhvbi4uLgpzZXQgQ1VSUkVOVF9ESVI9JX5kcDAKClJFTSBGaW5kIFB5dGhvbiBleGVjdXRhYmxlCndoZXJlIHB5dGhvbiA+bnVsIDI+JjEKaWYgZXJyb3JsZXZlbCAxICgKICAgIGVjaG8uCiAgICBlY2hvIFtFUlJPUl0gUHl0aG9uIG5vdCBmb3VuZCBpbiBQQVRIIQogICAgZWNoby4KICAgIGVjaG8gUGxlYXNlIGluc3RhbGwgUHl0aG9uIGZyb206IGh0dHBzOi8vd3d3LnB5dGhvbi5vcmcvZG93bmxvYWRzLwogICAgZWNobyBNYWtlIHN1cmUgdG8gY2hlY2sgIkFkZCBQeXRob24gdG8gUEFUSCIgZHVyaW5nIGluc3RhbGxhdGlvbgogICAgZWNoby4KICAgIHBhdXNlCiAgICBleGl0IC9iIDEKKQoKUkVNIEdldCBQeXRob24gcGF0aApmb3IgL2YgInRva2Vucz0qIiAlJWkgaW4gKCd3aGVyZSBweXRob24nKSBkbyBzZXQgUFlUSE9OX1BBVEg9JSVpCgplY2hvIEZvdW5kIFB5dGhvbjogJVBZVEhPTl9QQVRIJQplY2hvLgoKUkVNIEluc3RhbGwgUHl0aG9uIGRlcGVuZGVuY2llcwplY2hvIEluc3RhbGxpbmcgUHl0aG9uIGRlcGVuZGVuY2llcy4uLgplY2hvLgoiJVBZVEhPTl9QQVRIJSIgLW0gcGlwIGluc3RhbGwgLS11cGdyYWRlIHBpcCA+bnVsIDI+JjEKIiVQWVRIT05fUEFUSCUiIC1tIHBpcCBpbnN0YWxsIC1yICIlQ1VSUkVOVF9ESVIlcmVxdWlyZW1lbnRzLnR4dCIgLS1xdWlldAoKaWYgZXJyb3JsZXZlbCAxICgKICAgIGVjaG8uCiAgICBlY2hvIFtXQVJOSU5HXSBGYWlsZWQgdG8gaW5zdGFsbCBzb21lIGRlcGVuZGVuY2llcwogICAgZWNobyBUaGUgc2VydmljZSBtYXkgbm90IHdvcmsgcHJvcGVybHkKICAgIGVjaG8uCikgZWxzZSAoCiAgICBlY2hvIERlcGVuZGVuY2llcyBpbnN0YWxsZWQgc3VjY2Vzc2Z1bGx5IQogICAgZWNoby4KKQoKZWNobyBbNC80XSBJbnN0YWxsaW5nIFdpbmRvd3MgU2VydmljZS4uLgplY2hvLgoKUkVNIENoZWNrIGlmIHNlcnZpY2UgYWxyZWFkeSBleGlzdHMKbnNzbSBzdGF0dXMgQmlvbWV0cmljQnJpZGdlID5udWwgMj4mMQppZiBub3QgZXJyb3JsZXZlbCAxICgKICAgIGVjaG8gU2VydmljZSBhbHJlYWR5IGV4aXN0cy4gUmVtb3Zpbmcgb2xkIHNlcnZpY2UuLi4KICAgIG5zc20gc3RvcCBCaW9tZXRyaWNCcmlkZ2UgPm51bCAyPiYxCiAgICBuc3NtIHJlbW92ZSBCaW9tZXRyaWNCcmlkZ2UgY29uZmlybSA+bnVsIDI+JjEKICAgIHRpbWVvdXQgL3QgMiAvbm9icmVhayA+bnVsCiAgICBlY2hvLgopCgpSRU0gSW5zdGFsbCBzZXJ2aWNlIHdpdGggUHl0aG9uCm5zc20gaW5zdGFsbCBCaW9tZXRyaWNCcmlkZ2UgIiVQWVRIT05fUEFUSCUiICIlQ1VSUkVOVF9ESVIlYWdlbnQucHkiCgppZiBlcnJvcmxldmVsIDEgKAogICAgZWNoby4KICAgIGVjaG8gW0VSUk9SXSBGYWlsZWQgdG8gaW5zdGFsbCBzZXJ2aWNlCiAgICBlY2hvLgogICAgcGF1c2UKICAgIGV4aXQgL2IgMQopCgpSRU0gQ29uZmlndXJlIHNlcnZpY2UKbnNzbSBzZXQgQmlvbWV0cmljQnJpZGdlIEFwcERpcmVjdG9yeSAiJUNVUlJFTlRfRElSOn4wLC0xJSIKbnNzbSBzZXQgQmlvbWV0cmljQnJpZGdlIERpc3BsYXlOYW1lICJCaW9tZXRyaWMgQnJpZGdlIEFnZW50Igpuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgRGVzY3JpcHRpb24gIkNvbm5lY3RzIFpLVGVjbyBkZXZpY2UgdG8gcmVtb3RlIHNlcnZlciIKbnNzbSBzZXQgQmlvbWV0cmljQnJpZGdlIFN0YXJ0IFNFUlZJQ0VfQVVUT19TVEFSVApuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgQXBwU3Rkb3V0ICIlQ1VSUkVOVF9ESVI6fjAsLTElXHNlcnZpY2UubG9nIgpuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgQXBwU3RkZXJyICIlQ1VSUkVOVF9ESVI6fjAsLTElXHNlcnZpY2VfZXJyb3IubG9nIgoKUkVNIFNldCBlbnZpcm9ubWVudCB0byBhbGxvdyBuZXR3b3JrIGFjY2Vzcwpuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgQXBwRW52aXJvbm1lbnRFeHRyYSAiUFlUSE9OVU5CVUZGRVJFRD0xIgpuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgT2JqZWN0TmFtZSBMb2NhbFN5c3RlbQpuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgVHlwZSBTRVJWSUNFX1dJTjMyX09XTl9QUk9DRVNTCgpSRU0gU2V0IHRpbWVvdXRzIGZvciBsb25nLXJ1bm5pbmcgc2VydmljZQpuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgQXBwU3RvcE1ldGhvZFNraXAgMApuc3NtIHNldCBCaW9tZXRyaWNCcmlkZ2UgQXBwU3RvcE1ldGhvZENvbnNvbGUgMzAwMDAKbnNzbSBzZXQgQmlvbWV0cmljQnJpZGdlIEFwcEV4aXQgRGVmYXVsdCBSZXN0YXJ0Cm5zc20gc2V0IEJpb21ldHJpY0JyaWRnZSBBcHBSZXN0YXJ0RGVsYXkgNTAwMAoKZWNoby4KZWNobyBWZXJpZnlpbmcgY29uZmlndXJhdGlvbi4uLgplY2hvIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KbnNzbSBnZXQgQmlvbWV0cmljQnJpZGdlIEFwcGxpY2F0aW9uCm5zc20gZ2V0IEJpb21ldHJpY0JyaWRnZSBBcHBQYXJhbWV0ZXJzCm5zc20gZ2V0IEJpb21ldHJpY0JyaWRnZSBBcHBEaXJlY3RvcnkKZWNobyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmVjaG8uCgpSRU0gU3RhcnQgdGhlIHNlcnZpY2UKZWNobyBTdGFydGluZyBzZXJ2aWNlLi4uCm5zc20gc3RhcnQgQmlvbWV0cmljQnJpZGdlCgp0aW1lb3V0IC90IDMgL25vYnJlYWsgPm51bAoKbnNzbSBzdGF0dXMgQmlvbWV0cmljQnJpZGdlIHwgZmluZCAiU0VSVklDRV9SVU5OSU5HIiA+bnVsCmlmIGVycm9ybGV2ZWwgMSAoCiAgICBlY2hvLgogICAgZWNobyBbV0FSTklOR10gU2VydmljZSBpbnN0YWxsZWQgYnV0IG5vdCBydW5uaW5nCiAgICBlY2hvLgogICAgZWNobyBDaGVja2luZyBsb2dzLi4uCiAgICB0aW1lb3V0IC90IDIgL25vYnJlYWsgPm51bAogICAgCiAgICBpZiBleGlzdCAiJUNVUlJFTlRfRElSJWJyaWRnZV9hZ2VudC5sb2ciICgKICAgICAgICBlY2hvLgogICAgICAgIGVjaG8gTGFzdCAxMCBsaW5lcyBmcm9tIGJyaWRnZV9hZ2VudC5sb2c6CiAgICAgICAgZWNobyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgICAgcG93ZXJzaGVsbCAtQ29tbWFuZCAiR2V0LUNvbnRlbnQgJyVDVVJSRU5UX0RJUiVicmlkZ2VfYWdlbnQubG9nJyAtVGFpbCAxMCIKICAgICAgICBlY2hvIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICkKICAgIGVjaG8uCikgZWxzZSAoCiAgICBlY2hvLgogICAgZWNobyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICBlY2hvIFtTVUNDRVNTXSBTZXJ2aWNlIGlzIHJ1bm5pbmchCiAgICBlY2hvID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGVjaG8uCikKCmVjaG8uCmVjaG8gVXNlZnVsIGNvbW1hbmRzOgplY2hvICAgU3RhcnQ6ICAgbnNzbSBzdGFydCBCaW9tZXRyaWNCcmlkZ2UKZWNobyAgIFN0b3A6ICAgIG5zc20gc3RvcCBCaW9tZXRyaWNCcmlkZ2UKZWNobyAgIFJlc3RhcnQ6IG5zc20gcmVzdGFydCBCaW9tZXRyaWNCcmlkZ2UKZWNobyAgIFN0YXR1czogIG5zc20gc3RhdHVzIEJpb21ldHJpY0JyaWRnZQplY2hvICAgUmVtb3ZlOiAgbnNzbSByZW1vdmUgQmlvbWV0cmljQnJpZGdlIGNvbmZpcm0KZWNoby4KZWNobyBMb2dzIGxvY2F0aW9uOiAlQ1VSUkVOVF9ESVIlCmVjaG8gICAtIHNlcnZpY2UubG9nIChvdXRwdXQpCmVjaG8gICAtIHNlcnZpY2VfZXJyb3IubG9nIChlcnJvcnMpCmVjaG8uCnBhdXNlCg==')); $Utf8NoBom = New-Object System.Text.UTF8Encoding $False; [System.IO.File]::WriteAllText('%INSTALL_DIR%\install_service.bat', $content, $Utf8NoBom)"
echo Extracting uninstall_service.bat...
powershell -Command "$content = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String('QGVjaG8gb2ZmCmVjaG8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQplY2hvIFVuaW5zdGFsbGluZyBXaW5kb3dzIFNlcnZpY2UKZWNobyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmVjaG8uCgpSRU0gQ2hlY2sgYWRtaW4gcmlnaHRzCm5ldCBzZXNzaW9uID5udWwgMj4mMQppZiBlcnJvcmxldmVsIDEgKAogICAgZWNobyBFUlJPUjogUGxlYXNlIHJ1biBhcyBBZG1pbmlzdHJhdG9yIQogICAgcGF1c2UKICAgIGV4aXQgL2IgMQopCgpSRU0gQ2hlY2sgaWYgTlNTTSBleGlzdHMKaWYgbm90IGV4aXN0ICJuc3NtLmV4ZSIgKAogICAgZWNobyBFUlJPUjogTlNTTSBub3QgZm91bmQhCiAgICBlY2hvIFBsZWFzZSBydW4gaW5zdGFsbF9zZXJ2aWNlLmJhdCBmaXJzdAogICAgcGF1c2UKICAgIGV4aXQgL2IgMQopCgplY2hvIFN0b3BwaW5nIHNlcnZpY2UuLi4KbnNzbSBzdG9wIEJpb21ldHJpY0JyaWRnZQoKZWNobyBSZW1vdmluZyBzZXJ2aWNlLi4uCm5zc20gcmVtb3ZlIEJpb21ldHJpY0JyaWRnZSBjb25maXJtCgplY2hvLgplY2hvID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KZWNobyBTZXJ2aWNlIHVuaW5zdGFsbGVkIHN1Y2Nlc3NmdWxseSEKZWNobyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmVjaG8uCnBhdXNlCg==')); $Utf8NoBom = New-Object System.Text.UTF8Encoding $False; [System.IO.File]::WriteAllText('%INSTALL_DIR%\uninstall_service.bat', $content, $Utf8NoBom)"


echo.
echo [3/3] Installing Windows Service...
echo.

REM Run service installer
cd /d "%INSTALL_DIR%"
call install_service.bat

echo.
echo ========================================
echo Installation Complete!
echo ========================================
echo.
echo Location: %INSTALL_DIR%
echo.
echo The service is now running in the background.
echo.
pause